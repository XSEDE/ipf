{
  "name": "slurm_combined",
  "description": "Watches the SLURM reporting file to publish updates about individual jobs and trigger the compute workflow",
  "steps": [
    { "name": "teragrid.sysinfo.ResourceNameStep" },
    { "name": "teragrid.sysinfo.SiteNameStep" },
    { "name": "glue2.slurm.ComputingActivityUpdateStep" },
    {
      "name": "ipf.publish.AmqpStep",
      "params": {
        "publish": ["glue2.computing_activity.ComputingActivityIpfJson"],
        "services": [ "info1.dyn.teragrid.org", "info2.dyn.teragrid.org" ],
        "ssl_options": {
          "keyfile": "key.pem",
          "certfile": "cert.pem",
          "ca_certs": "ca_certs.pem"
        },
	"vhost": "xsede_private",
        "exchange": "glue2.computing_activity"
      }
    },
    { "name": "ipf.step.WorkflowStep",
      "params": {
        "trigger": ["glue2.computing_activity.ComputingActivityIpfJson"],
        "minimum_interval": 120,
        "maximum_interval": 900,
        "workflow": "xsede/glue2/slurm_compute.json"
      }
    }
  ]
}
